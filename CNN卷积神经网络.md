[CNN Explainer(可视化CNN图像识别)](https://poloclub.github.io/cnn-explainer/)

图像信息使用RGB通道保存，如若 800\*500 像素的图片做 猫/狗 二元分类任务，输入层1200k而输出层2，中间隐藏层会过于复杂
**这时需要 CNN 降低复杂性**

## 卷积
[用信号分析的例子理解卷积](https://www.zhihu.com/question/22298352/answer/637156871)
卷积Convolution 指 将两个函数$f,g$中的一个翻转，平移，与另一个函数叠加得到新函数的过程
$$(f * g)(n) = \sum_{m=-\infty}^{\infty} f(m) \cdot g(n - m)
$$
- $n$ 自变量，理解为对$f,g$进行卷积操作的约束范围
#### 理解 f g
- $f$ 代表初始条件/输入信号
- $g$ 代表系统对$f$的响应
e.g. 图像处理
- $f$ 代表未处理的图像
- $g$ 代表对图像的操作方式，比如
	- 平滑化 （将当前像素替换为周围的均值）$$\frac{1}{9}
\begin{bmatrix}
1 & 1 & 1 \\
1 & 1 & 1 \\
1 & 1 & 1 \\
\end{bmatrix}
$$
	- 尖锐化（加大当前像素和周围的差距，从而强调图像中的边缘）$$
\begin{bmatrix}
-1 & -1 & -1 \\
-1 & 8 & -1 \\
-1 & -1 & -1 \\
\end{bmatrix}
$$
## 卷积神经网络层级结构
按照计算图中顺序：
- 输入层
- 卷积层 通过卷积计算提取特征 **这一层综合局部信息**
	- e.g. 图像处理 卷积核（e.g. 3\*3像素窗口）以一定步长扫描计算整个图像的卷积
	- 减少特征空间尺寸，增加深度（新的特征空间深度和使用的卷积核数目相同 i.e. 新特征空间的每个通道都代表一个不同的卷积）
	- 可操作的概念
		- depth == 卷积核数目
		- stride 步长
		- zero-padding 是否在图像周边填充0，以抵消一轮卷积操作后图片的缩小
- 激活层 对提取出的特征应用**激活函数**，进行非线性映射
	- ReLU (最常用)
	- Sigmoid (只在全连接层建议使用)
	- [[Logistic & Softmax#^0352f6|Softmax]] (多分类任务的输出层)
	- ...
- 池化层 将每个局部区域进行**池化操作**，将局部区域缩减为一个单一值，来减少特征数
	- 最大池化：用区域内最大值代表区域
	- 平均赤化：用区域内平均值代表区域
	池化层输出缩小了的feature map，有多通道结构。将feature map 展平(flatten)为一维向量，才能交给全连接层
- 全连接层 整合前面的卷积层和池化层提取的特征（flatten），转换为高维的特征向量
- 输出层 激活函数取决于具体任务
Optional：Batch Normalization Layer 

## 数据预处理
常见方式
- 去均值&[[数据清洗和特征工程#^67faeb|标准化]]（一般选择）
- [[数据清洗和特征工程#^d042ee|PCA]]&白化（将PCA后的数据沿特征轴标准化） 
也可以用OpenCV等库提供的图像处理技术